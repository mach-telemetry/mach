syntax = "proto3";
package mach_rpc;

// The definition for serving global state
service TsdbService {
  rpc AddSeries(AddSeriesRequest) returns (AddSeriesResponse) {}
  rpc Echo(EchoRequest) returns (EchoResponse) {}
  rpc Map(MapRequest) returns (MapResponse) {}
  rpc EchoStream(stream EchoRequest) returns (stream EchoResponse) {}
  rpc MapStream(stream MapRequest) returns (stream MapResponse) {}
}

message EchoRequest {
  string msg = 1;
}

message EchoResponse {
  string msg = 1;
}

message MapRequest {
  map<uint64, uint64> samples = 1;
}

message MapResponse {
  map<uint64, bool> samples = 1;
}

message AddSeriesRequest {
  enum ValueType {
      U64 = 0;
      F64 = 1;
      Bytes = 2;
  }
  message Tag {
    string key = 1;
    string value = 2;
  }
  repeated ValueType types = 1;
  repeated Tag tags = 2;
}

message AddSeriesResponse {
  string writer_address = 1;
  uint64 series_id = 2;
}

// The definition for serving global state
service WriterService {
  rpc Echo(EchoRequest) returns (EchoResponse) {}
  rpc MapStream(stream MapRequest) returns (stream MapResponse) {}
}


